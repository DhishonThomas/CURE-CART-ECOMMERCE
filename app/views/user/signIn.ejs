  <%- include('../partialsUser/header') -%>
      

 		   <main class="main">
            <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
                <div class="container">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item"><a href="#">Pages</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Login</li>
                    </ol>
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->
<div class="login-page bg-image pt-8 pb-8 pt-md-12 pb-md-12 pt-lg-17 pb-lg-17" style="background-image: url('assets/images/backgrounds/login-bg.jpg')">
    <div class="container">
        <div class="form-box">
            <div class="form-tab">
                <ul class="nav nav-pills nav-fill" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="register-tab-2" data-toggle="tab" href="#register-2" role="tab" aria-controls="register-2" aria-selected="true">Sign In</a>
                    </li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane fade show active" id="register-2" role="tabpanel" aria-labelledby="register-tab-2">
                        <form action="/signIn" method="post" id="formblock">
                            <!-- Your existing form fields go here -->

                            <div class="form-group">
                                <label for="register-email-2">Your email address *</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                                <span id="usernameError" style="color: red;"></span><br>
                            </div>

                            <div class="form-group">
                                <label for="register-password-2">Password *</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                                <span id="usernameError" style="color: red;"></span><br>
                            </div><!-- End .form-group -->
                            <span id="current-time"></span>

                            <div class="form-footer">
                                <button type="submit" class="btn btn-outline-primary-2" id="signUpButton">
                                    <span>SIGN IN</span>
                                    <i class="icon-long"></i>
                                </button>
                                <!-- Add Forgot Password link -->
                                <a href="/forgot-password" class="forgot-password-link">Forgot Password?</a>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Add Sign Up link below the form -->
                <div class="form-choice">
                    <p class="text-center">Don't have an account? <a href="/signUp">Sign Up</a></p>
                </div>
            </div><!-- End .form-tab -->
        </div><!-- End .form-box -->
    </div><!-- End .container -->
</div><!-- End .login-page section-bg -->


							 
<!-- 
			                				<div class="custom-control custom-checkbox">
												<input type="checkbox" class="custom-control-input" id="register-policy-2" required>
												<label class="custom-control-label" for="register-policy-2">I agree to the <a href="#">privacy policy</a> *</label>
											</div>End .custom-checkbox
							    		</div>End .form-footer
							    	</form>
							    	<div class="form-choice">
								    	<p class="text-center">or sign in with</p>
								    	<div class="row">
								    		<div class="col-sm-6">
								    			<a href="#" class="btn btn-login btn-g">
								    				<i class="icon-google"></i>
								    				Login With Google
								    			</a>
								    		</div>End .col-6
								    		<div class="col-sm-6">
								    			<a href="#" class="btn btn-login  btn-f">
								    				<i class="icon-facebook-f"></i>
								    				Login With Facebook
								    			</a>
								    		</div>End .col-6
								    	</div>End .row -->
							    	</div><!-- End .form-choice -->
							    </div><!-- .End .tab-pane -->
							</div><!-- End .tab-content -->
						</div><!-- End .form-tab -->
            		</div><!-- End .form-box -->
            	</div><!-- End .container -->
            </div><!-- End .login-page section-bg -->
        </main><!-- End .main -->


<!-- Add this script at the end of your HTML body -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const emailInput = document.getElementById("email");
    const sendOtpButton = document.getElementById("sendOtpButton");
    const otpInput = document.getElementById("otp");
    const verifyOtpButton = document.getElementById("verifyOtpButton");
    const resendOtpButton = document.getElementById("resendOtpButton");
    const timerDisplay = document.getElementById("timer");

    let timer;
    let timeLeft = 60; // Set the initial timer value in seconds

    sendOtpButton.addEventListener("click", function () {
      const email = emailInput.value;

      // Make an API request to your server to check if the email exists
      // You need to replace the URL with your actual server endpoint
      fetch(`/sendOtp?email=${email}`)
        // .then((response) => response.json())
        .then((data) => {
          if (data.exsists) {
             usernameError.innerText = 'Username already taken';
          } else {
            enableOtpSection();
            startTimer();
          }
        })
        .catch((error) => {
          console.error("Error checking email:", error);
        });
    });

    verifyOtpButton.addEventListener("click", function () {
      const otp = otpInput.value;

      // Make an API request to your server to verify the OTP
      // You need to replace the URL with your actual server endpoint
      fetch(`/verifyOtp?otp=${otp}`)
        .then((response) => response.json())
        .then((data) => {
          if (data.verified) {
            alert("OTP Verified Successfully");
          } else {
            alert("Invalid OTP. Please try again.");
          }
        })
        .catch((error) => {
          console.error("Error verifying OTP:", error);
        });
    });

    resendOtpButton.addEventListener("click", function () {
      startTimer();
      // Make an API request to your server to resend the OTP
      // You need to replace the URL with your actual server endpoint
      fetch(`/api/resendOtp`)
        .then((response) => response.json())
        .then((data) => {
          if (data.sent) {
            alert("OTP Resent Successfully");
          } else {
            alert("Failed to resend OTP. Please try again.");
          }
        })
        .catch((error) => {
          console.error("Error resending OTP:", error);
        });
    });

    function enableOtpSection() {
      // Enable OTP input, verify button, and disable send button
      otpInput.removeAttribute("disabled");
      verifyOtpButton.removeAttribute("disabled");
      sendOtpButton.setAttribute("disabled", true);
    }

    function startTimer() {
      timer = setInterval(function () {
        timeLeft--;
        timerDisplay.textContent = `Time Left: ${timeLeft}s`;

        if (timeLeft <= 0) {
          clearInterval(timer);
          timerDisplay.textContent = "Resend OTP";
          resendOtpButton.removeAttribute("disabled");
        }
      }, 1000);
    }
  });
</script>


<%- include('../partialsUser/footer') -%>
